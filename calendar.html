<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8"/>
        <title>calendar</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
        <link rel="stylesheet" href="calendar.css">
        <script type="text/javascript" src="calscript.js"></script>
        <script type="text/javascript" src="calendar.min.js"></script>
    </head>
    <body>
        <h1>Your Calendar</h1>
        <h3 id="month_label"></h3>
        <button id="prev_month_btn">prev month</button>
        <button id="next_month_btn">next month</button>

        <div id="popUp">
            <h1>new event</h1>
            <form name="form" action="" method="post" enctype="multipart/form-data">
                    <input type="text" name="event_name" id="event_name" placeholder="event name"><br> 
                    <input type="text" name="start_date" id="start_date" placeholder="start date and time"><br> 
                    <input type="text" name="end_date" id="end_date"placeholder="end date and time"><br> 
                    <input type="text" name="location" id="location" placeholder="location"><br>
                    <input type="submit" name="submit" value="Add Event">
            </form>
        </div>
       
        <table id="calendar">
            <tr>
                <td>Sunday</td><td>Monday</td><td>Tuesday</td><td>Wednesday</td><td>Thursday</td><td>Friday</td><td>Saturday</td>
            </tr>
            <tr id="week1" class="week"></tr>
            <tr id="week2" class="week"></tr>
            <tr id="week3" class="week"></tr>
            <tr id="week4" class="week"></tr>
            <tr id="week5" class="week"></tr>
        </table>
    </body>
</html>

<script>
    
    var currentMonth = new Month(2018, 9); // current month is October 2018
    document.getElementById("month_label").innerHTML = getMonthName()+" "+currentMonth.year;
    updateCalendar(); // show the calendar

    // Change the month when the "next" button is pressed
    document.getElementById("next_month_btn").addEventListener("click", function(){
        currentMonth = currentMonth.nextMonth();
        updateCalendar(); 
        document.getElementById("month_label").innerHTML = getMonthName() +" "+currentMonth.year;
    }, false);

    document.getElementById("prev_month_btn").addEventListener("click", function(){
        currentMonth = currentMonth.prevMonth();
        updateCalendar(); 
        document.getElementById("month_label").innerHTML = getMonthName() +" "+currentMonth.year;
    }, false);

    addListeners(document.getElementsByClassName("day_this_month"));
</script>
<script>
        let form = document.getElementById("popUp");
        console.log("hello")
        form.addEventListener('submit', function(ev) {
        console.log("hey")
        var oOutput = document.querySelector("div"),
            oData = new FormData(form);

        //oData.append("CustomField", "This is some extra data"); LETS USE THIS TO PASS USERNAME

        var oReq = new XMLHttpRequest();
        oReq.open("POST", "addevent.php", true);
        oReq.onload = function(oEvent) {

            console.log("fuck yea")

            if (oReq.status == 200) {
            oOutput.innerHTML = "Uploaded!";
            } else {
            oOutput.innerHTML = "Error " + oReq.status + " occurred when trying to upload your event.<br \/>";
            }
        };

        console.log("hey")

        oReq.send(oData);
        ev.preventDefault();
        }, false);
                
    </script>